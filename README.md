# Проект API для управления пользователями

## Описание

Этот проект предоставляет API для управления пользователями и их профилями. Он позволяет регистрировать пользователей, подтверждать верификационные коды, управлять профилями пользователей и активировать пригласительные коды.

## Установка и запуск

1. Клонируйте репозиторий:
   ```
   git clone git@github.com:Ostashev/authorization_phone.git
   ```
2. Перейдите в директорию проекта:
   ```
   cd authorization_phone
   ```
3. Создайте файл .env:
   ```
   DEBUG=FALSE
   SECRET_KEY=...
   ALLOWED_HOSTS=localhost 127.0.0.1 ... ...

   POSTGRES_USER=django_user
   POSTGRES_PASSWORD=mysecretpassword
   POSTGRES_DB=django
   DB_HOST=db
   DB_PORT=5432
   DB_NAME=name
   ```
4. Запустите проект в контейнерах:
   ```
   sudo docker compose up
   ```
5. Выполните миграции:
   ```
   sudo docker compose exec backend python manage.py migrate
   ```

## Эндпоинты API

### 1. Создание пользователя и отправка верификационного кода

- **URL:** `/request_phone_number/`
- **Метод:** `POST`
- **Параметры запроса:**
- `phone_number` (строка, обязательный) - номер телефона пользователя.
- **Успешный ответ:**
- Код: 200 OK
- Тело ответа: JSON объект с данными пользователя.

### 2. Подтверждение верификационного кода

- **URL:** `/verify_code/`
- **Метод:** `POST`
- **Параметры запроса:**
- `phone_number` (строка, обязательный) - номер телефона пользователя.
- `verification_code` (строка, обязательный) - верификационный код.
- **Успешный ответ:**
- Код: 200 OK
- Тело ответа: JSON объект с токеном доступа.

### 3. Получение профиля пользователя

- **URL:** `/user_profile/`
- **Метод:** `GET`
- **Требуется авторизация.**
- **Успешный ответ:**
- Код: 200 OK
- Тело ответа: JSON объект с данными профиля пользователя.

### 4. Создание профиля пользователя с активацией пригласительного кода

- **URL:** `/user_profile/`
- **Метод:** `POST`
- **Требуется авторизация.**
- **Параметры запроса:**
- `invite_code` (строка, опциональный) - пригласительный код.
- **Успешный ответ:**
- Код: 200 OK
- Тело ответа: JSON объект с сообщением.

## Примеры использования API

### 1. Создание пользователя и получение верификационного кода

- **URL:** `/request_phone_number/`
- **Метод:** `POST`
- **Параметры запроса:**
- `{"phone_number": "8900000000"}
- **Успешный ответ:**
- {
  "phone_number": "8900000000",
  "verification_code": "1234"
  }
- **Ошибка:**
- {
  "error": "Данный номер уже зарегистрирован!"
  }

### 2. Подтверждение верификационного кода

- **URL:** `/verify_code/`
- **Метод:** `POST`
- **Параметры запроса:**
- `{
  "phone_number": "8900000000",
  "verification_code": "1234"
   }
- **Успешный ответ:**
- {
  "message": "Проверка прошла успешно!",
  "token": "your_access_token"
  }
- **Ошибка:**
- {
  "error": "Неверный код!"
  }

### 3. Получение профиля пользователя

- **URL:** `/user_profile/`
- **Метод:** `GET`
- **Требуется авторизация.**
- **Успешный ответ:**
- {
  "id": 1,
  "phone_number": "8900000000",
  "verification_code": "1234",
  "verified": true,
  "invite_code": "ABCD1234",
  "activated_invite_code": "EFGH5678",
  "invited_users": [
    {
      "id": 2,
      "phone_number": "9876543210"
    }
  ]

}

### 4. Создание профиля пользователя с активацией пригласительного кода

- **URL:** `/user_profile/`
- **Метод:** `POST`
- **Требуется авторизация.**
- **Параметры запроса:**
- {"invite_code": "ABCD1235"}
- **Успешный ответ:**
- {
  "message": "Код успешно активирован!"
  }
- **Ошибка:**
- {
  "error": "Неверный код!"
  }

## Интерфейс на Django Templates

Для удобства тестирования можете перейти по адресу:
```
http://localhost:8000/
```

